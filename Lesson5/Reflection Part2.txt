Решение в ответе к заданию понятно. Вопросов не осталось.

В своем ответе решил упростить работу над методами классов, которыми дополнил эти классы.
В решении была идея сделать что-то наглядное, простое и понятное.